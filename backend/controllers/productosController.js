const fs = require('fs');
const path = require('path');

const { put } = require('@vercel/blob');


const db = require('../db/db');

const saludar = (req, res) => {
    res.send("holaMundo")
  };


//   module.exports = {
    
//     saludar
// }


 const getAllProductos = (req, res) => {
    const sql = 'SELECT * FROM productos';
     db.query(sql, (err, results) => {
         if (err) throw err;
            res.json(results);
        });
 };


 const getProductoById = (req, res) => {
    const { id } = req.params;
    const sql = 'SELECT * FROM productos WHERE id = ?';
    db.query(sql, [id], (err, result) => {
        if (err) throw err;
            res.json(result);
        });
};

    const guardarArchivo = async(req, res) => {
        
        let img_noencontrada = "data:image/png;base64,/9j/4AAQSkZJRgABAQEBLAEsAAD/4QEDRXhpZgAASUkqAAgAAAADAA4BAgC5AAAAMgAAABoBBQABAAAA6wAAABsBBQABAAAA8wAAAAAAAABibGFjayBsaW5lYXIgcGhvdG8gY2FtZXJhIGxpa2Ugbm8gaW1hZ2UgYXZhaWxhYmxlLiBmbGF0IHN0cm9rZSBzdHlsZSB0cmVuZCBtb2Rlcm4gYXJ0IGRlc2lnbiBvbiB3aGl0ZS4gY29uY2VwdCBvZiBwaWN0dXJlIGNvbWluZyBzb29uIHdpbGwgYXBwZWFyIG9uIHdlYnNpdGUgYW5kIHBob3RvZ3JhcGggbm90IGRpc3BsYXllZCwBAAABAAAALAEAAAEAAAD/4QY0aHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/Pgo8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIj4KCTxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+CgkJPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczpJcHRjNHhtcENvcmU9Imh0dHA6Ly9pcHRjLm9yZy9zdGQvSXB0YzR4bXBDb3JlLzEuMC94bWxucy8iICAgeG1sbnM6R2V0dHlJbWFnZXNHSUZUPSJodHRwOi8veG1wLmdldHR5aW1hZ2VzLmNvbS9naWZ0LzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGx1cz0iaHR0cDovL25zLnVzZXBsdXMub3JnL2xkZi94bXAvMS4wLyIgIHhtbG5zOmlwdGNFeHQ9Imh0dHA6Ly9pcHRjLm9yZy9zdGQvSXB0YzR4bXBFeHQvMjAwOC0wMi0yOS8iIHhtbG5zOnhtcFJpZ2h0cz0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3JpZ2h0cy8iIHBob3Rvc2hvcDpDcmVkaXQ9IkdldHR5IEltYWdlcy9pU3RvY2twaG90byIgR2V0dHlJbWFnZXNHSUZUOkFzc2V0SUQ9IjEwNTUwNzk2ODAiIHhtcFJpZ2h0czpXZWJTdGF0ZW1lbnQ9Imh0dHBzOi8vd3d3LmlzdG9ja3Bob3RvLmNvbS9sZWdhbC9saWNlbnNlLWFncmVlbWVudD91dG1fbWVkaXVtPW9yZ2FuaWMmYW1wO3V0bV9zb3VyY2U9Z29vZ2xlJmFtcDt1dG1fY2FtcGFpZ249aXB0Y3VybCIgcGx1czpEYXRhTWluaW5nPSJodHRwOi8vbnMudXNlcGx1cy5vcmcvbGRmL3ZvY2FiL0RNSS1QUk9ISUJJVEVELUVYQ0VQVFNFQVJDSEVOR0lORUlOREVYSU5HIiA+CjxkYzpjcmVhdG9yPjxyZGY6U2VxPjxyZGY6bGk+SW5mYWRlbDwvcmRmOmxpPjwvcmRmOlNlcT48L2RjOmNyZWF0b3I+PGRjOmRlc2NyaXB0aW9uPjxyZGY6QWx0PjxyZGY6bGkgeG1sOmxhbmc9IngtZGVmYXVsdCI+YmxhY2sgbGluZWFyIHBob3RvIGNhbWVyYSBsaWtlIG5vIGltYWdlIGF2YWlsYWJsZS4gZmxhdCBzdHJva2Ugc3R5bGUgdHJlbmQgbW9kZXJuIGFydCBkZXNpZ24gb24gd2hpdGUuIGNvbmNlcHQgb2YgcGljdHVyZSBjb21pbmcgc29vbiB3aWxsIGFwcGVhciBvbiB3ZWJzaXRlIGFuZCBwaG90b2dyYXBoIG5vdCBkaXNwbGF5ZWQ8L3JkZjpsaT48L3JkZjpBbHQ+PC9kYzpkZXNjcmlwdGlvbj4KPHBsdXM6TGljZW5zb3I+PHJkZjpTZXE+PHJkZjpsaSByZGY6cGFyc2VUeXBlPSdSZXNvdXJjZSc+PHBsdXM6TGljZW5zb3JVUkw+aHR0cHM6Ly93d3cuaXN0b2NrcGhvdG8uY29tL3Bob3RvL2xpY2Vuc2UtZ20xMDU1MDc5NjgwLT91dG1fbWVkaXVtPW9yZ2FuaWMmYW1wO3V0bV9zb3VyY2U9Z29vZ2xlJmFtcDt1dG1fY2FtcGFpZ249aXB0Y3VybDwvcGx1czpMaWNlbnNvclVSTD48L3JkZjpsaT48L3JkZjpTZXE+PC9wbHVzOkxpY2Vu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"

        const matches = img_noencontrada.match(/^data:(.+);base64,(.+)$/);
            if (!matches) {
            throw new Error('Cadena base64 no válida');
              }
        const mimeType = matches[1];
        const base64Data = matches[2];
        const buffer = Buffer.from(base64Data, 'base64');

        const token = process.env.BLOB_READ_WRITE_TOKEN || 'vercel_blob_rw_I48PJYG3cH4GheoJ_odguPfSZoxdwwFHTwovaqnD0S3U8zc';

        const { url } = await put('img_storage/123.png', buffer, { access: 'public',  token: token });
        // const { url } = await put('img_storage/123.txt', 'Hello World!', { access: 'public',  token: token });
             res.json({message: 'Archivo guardado'});
        
 }; 

// app.get('/image/:name', (req, res) => {
//     const imageName = req.params.name;
//     const imagePath = path.join(__dirname, 'public/images', imageName);

//     res.sendFile(imagePath, (err) => {
//         if (err) {
//             res.status(404).send('Imagen no encontrada');
//         }
//     });
// });


const updateProducto = (req, res) => {
    const { id } = req.params;
    const { nombre, descripcion, precio, stock } = req.body;
    const sql = 'UPDATE productos SET nombre = ?, descripcion = ?, precio = ?, stock = ? WHERE id = ?';
    db.query(sql, [nombre, descripcion, precio, stock, id], (err, result) => {
        if (err) throw err;
            res.json({message: 'Producto actualizado'});
        });
};

const createProducto = (req, res) => {
    const { nombre, descripcion, precio, stock, categoria_id } = req.body;
    const sql = 'INSERT INTO productos (nombre, descripcion, precio, stock, categoria_id) VALUES (?, ?, ?, ?, ?)';
    db.query(sql, [nombre, descripcion, precio, stock, categoria_id], (err, result) => {
        if (err) throw err;
            res.json({message: 'Producto creado', producto_id: result.insertId});
        });
};

const deleteProducto = (req, res) => {
    const { id } = req.params;
    const sql = 'DELETE FROM productos WHERE id = ?';
    db.query(sql, [id], (err, results) => {
        if (err) {res.json({message: err})};
            res.json({message: 'Poducto eliminado'});
        });
};

 module.exports = {
    getAllProductos,
    getProductoById,
    updateProducto,
    createProducto,
    deleteProducto,
    guardarArchivo,
    saludar
}

